# TODO List Web Server

## Описание проекта

Веб-сервер для управления задачами TODO list. Приложение позволяет создавать, просматривать, обновлять и удалять задачи, а также отмечать их как выполненные.

Основные функции:

Создание и управление задачами

Автоматический расчет следующих дат для повторяющихся задач

Аутентификация пользователей по паролю

Веб-интерфейс для удобной работы

## Список выполненных задач со звездочкой

1. Реализована возможность менять порт через переменную окружения `TODO_PORT`.
2. Реализована возможность определять путь к файлу базы данных через переменную окружения `TODO_DBFILE`.
3. Реализованы правила для недель `w` и месяцев `m` в nextDate.
4. Реализована возможость поиска через строку для поиска в браузере.
5. Реализована аутентификация по паролю.
6. Создан Dockerfile для создания образа.

## Инструкция по запуску кода локально

### Предварительные требования

Go 1.23.4 или выше  
SQlite3

### Запуск приложения

1. Клонируйте репозиторий:  
`git clone <url-репозитория>`
`cd GoFinal`
2. Установите зависимости:  
`go mod download`
3. Запустите сервер:  
`go run main.go`
4. Откройте в браузере приложение:  
http://localhost:7540

### Настройка окружения (опционально)

`export TODO_PORT= <ваш порт на выбор>`  
`export TODO_DBFILE= <альтернативный путь к бд>`  
`export TODO_PASSWORD= <пароль для аутентификации пользователей если нужен>`

## Интсрукция по запуску тестов

### Параметры в tests/settings.go в соответствии с выполненными заданиями
```
package tests

var Port = 7540
var DBFile = "../scheduler.db"
var FullNextDate = true
var Search = true
var Token = "<ваш токен вовзращенный сервером из signin в куке token>"
```
Для получения токена при установленном пароле (например 12345) я использовал
`$ curl -X POST http://localhost:7540/api/signin   -H "Content-Type: application/json"   -d '{"password":"12345"}'`

### Запуск всех тестов

`go test ./tests`

### Запуск индивидуальный тестов
1. Проверка запуска сервера:  
`go test -run ^TestApp$ ./tests`
2. Тест бд:  
`go test -run ^TestDB$ ./tests`
3. Тестирование расчета следующей даты:  
`go test -run ^TestNextDate$ ./tests`
4. Тестирование добавление задачи в браузере:  
`go test -run ^TestAddTask$ ./tests`
5. Тестирование поиска:  
`go test -run ^TestTasks$ ./tests`
6. Тестирование отображения задачи:  
`go test -run ^TestTask$ ./tests`
7. Тестирование редактирования задач в браузере:  
`go test -run ^TestEditTask$ ./tests`
8. Тестирование подтверждения выполнения задач:  
`go test -run ^TestDone$ ./tests`
9. Тестирование удаления задач:  
`go test -run ^TestDelTask$ ./tests`

## Инструкция по сборке и запуску через Docker

Базово в Dockerfile определены `TODO_PORT=7540` и `TODO_PASSWORD=12345`

### Сборка Docker-образа

`docker build -t todo-app .`

### Запуск контейнера

Базовый запуск (данные сохраняются в контейнере)  
`docker run -d --name todo-app -p 7540:7540 todo-app`

С сохранением данных в Docker volume  
`docker run -d --name todo-app -p 7540:7540 -v todo-db:/app todo-app`

Для изменения ENV нужно добавить доп аргументы, например:  
`docker run -d --name todo-app -p 7540:7540 -v todo-db:/app -e TODO_PORT=8080 -e TODO_PASSWORD=1234 todo-app`

### Доступ к приложению
После запуска откройте в браузере: http://localhost:7540


### Управление контейнером

Остановка контейнера  
`docker stop todo-app`

Запуск остановленного контейнера  
`docker start todo-app`

Просмотр логов  
`docker logs todo-app`

Удаление контейнера  
`docker rm -f todo-app`